
Проверка при регистрации

SELECT users.name
FROM users
WHERE users.name = {login} 

if empty

Добавление пользователя

INSERT INTO users VALUES
({str(user_data)})

Персональные настройки

UPDATE users SET {param} = {val}


Выбор набора пакетов, доступных пользователю

this_user_packs = (
SELECT * FROM user_packs
WHERE user_packs.user_id = {user_id}
)

SELECT packs.name, pack_stat(this_user_packs)
FROM this_user_packs, packs
WHERE this_user_packs.pack_id = packs.pack_id

Выбор карточек

this_pack_cards = (
SELECT * FROM pack_cards
WHERE pack_cards.pack_id = {pack.id}
)

SELECT * 
FROM user_cards, this_pack_cards
WHERE user_cads.user_id = {user_id)
	AND this_pack_cards.card_id = user_cards.card.id
	AND status = ‘ACTIVE’

Апдейт карточки

TBC

Апдейт пака

TBC

Добавить пакет

а) Найти доступные пакеты

SELECT packs.pack_id, packs.goal
FROM packs
WHERE packs.privacy = ‘public’;

SELECT packs.pack_id, pack.goal
FROM packs, access_rights
WHERE packs.pack_id = access_rights.pack_id
	AND access_rights.user_id = {user.id}
	AND access_rights.rights_type = ‘view’;

б) Добавить к себе
INSERT INTO user_packs VALUES
({user_id}, {pack_id}, {pack_status})

